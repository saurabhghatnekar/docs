---
id: backend-config
title: 2. Backend config
hide_title: true
---

import AppInfoForm from "/src/components/appInfoForm"
import CoreInjector from "/src/components/coreInjector"

# 2. Backend config

## 1) Add layers for supertokens and middy

- Download the zip files here
1. supertokens -> https://github.com/saurabhghatnekar/supertokens-aws-lambda/raw/main/supertokens-node.zip
2. @middy/core -> https://github.com/saurabhghatnekar/supertokens-aws-lambda/raw/main/middy-core-node.zip
3. @middy/http-cors -> https://github.com/saurabhghatnekar/supertokens-aws-lambda/raw/main/middy-http-node.zip

- Now, head to AWS Lambda.
As shown in the image below, click on layers
[image](https://user-images.githubusercontent.com/20884782/190074706-3d1b6420-e812-48d9-aa04-8ea2d4a4c62d.png)

- Then, click in "Create Layer" button
![image](https://user-images.githubusercontent.com/20884782/190075143-57768a61-7efc-4b3d-a865-0d68e84f3005.png)

- Give a name for your layer, upload the zip and select the nodejs 16 runtime
![image](https://user-images.githubusercontent.com/20884782/190076214-47e1ba13-3f17-4dcb-afc9-90b3e8c0f53c.png)

- Repeat this for all the 3 modules.

## 2) Create a new Lambda Function
- Create a new lambda function with Node 16 runtime


## 3) Create a configuration file (`config.js`)
- Create a `config.js` file in the root directory of your project.
- An example of this file can be found [here](https://github.com/supertokens/supertokens-auth-react/blob/master/examples/with-aws-lambda/backend/config.js).


## 4) Create a backend config function

<AppInfoForm
    askForAppName
    askForAPIDomain
    askForWebsiteDomain
>

<CoreInjector>

```tsx title="config.ts"

import EmailPassword from 'supertokens-node/recipe/emailpassword';
import Session from 'supertokens-node/recipe/session'

function getBackendConfig() {
  return {
    framework: "awsLambda",
    supertokens: {
      ^{coreInjector_connection_uri_comment}
      connectionURI: ^{coreInjector_uri}
      ^{coreInjector_api_key_commented}apiKey: ^{coreInjector_api_key},
    },
    appInfo: {
      // learn more about this on https://supertokens.com/docs/emailpassword/appinfo
      appName: "^{form_appName}",
      apiDomain: "^{form_apiDomain}",
      websiteDomain: "^{form_websiteDomain}",
      apiBasePath: "^{form_apiBasePath}",
      websiteBasePath: "^{form_websiteBasePath}",
      apiGatewayPath: "/dev" // TODO: same as what's set on the frontend config
    },
    recipeList: [
      EmailPassword.init(),
      Session.init(),
    ],
    isInServerlessEnv: true,
  }
}

module.exports.getBackendConfig = getBackendConfig;

```

</CoreInjector>

</AppInfoForm>


## 4) Create a backend config function

- Scroll to the bottom and look for the `Layers` tab. Click on add layers
![image](https://user-images.githubusercontent.com/20884782/190076987-02e9f585-d870-4dac-bd96-d55ce71596c4.png)

- Select `Custom Layer` and then select the layer we created in the first step.
![Lambda 2022-09-14 at 12 01 59 PM](https://user-images.githubusercontent.com/20884782/190077385-55f9db2f-190b-42ed-ab09-70d94ec3b7a3.jpg)

-  Add the 3 layers we created in the first step. You layers tab should look something like this
![supertokens - Lambda 2022-09-14 at 12 04 22 PM](https://user-images.githubusercontent.com/20884782/190077670-fa4d1db4-67c6-4827-b52f-3f978d36b2be.jpg)

import EmailPassword from 'supertokens-node/recipe/emailpassword';
